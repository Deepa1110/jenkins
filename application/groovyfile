pipeline {
  agent none
  stages {
    stage('Back-end') {
      agent {
        docker { image 'maven:3.8.1-adoptopenjdk-11' }
      }
      steps {
        script {
          // Checkout source code from the correct repository URL
          git 'https://github.com/Deepa1110/jenkins.git'

          // Navigate to the backend directory if necessary
          dir('application/back-end') {  // Adjusted to match the correct path in your repo
            // Display Maven version
            sh 'mvn --version'

            // Compile the project
            sh 'mvn clean compile'

            // Run tests
            sh 'mvn test'
            
            // Package the application (creates a JAR file)
            sh 'mvn package'
          }
        }
      }
    }
    stage('Front-end') {
      agent {
        docker { image 'node:16-alpine' }
      }
      steps {
        script {
          // Checkout source code from the same repository URL
          git 'https://github.com/Deepa1110/jenkins.git'

          // Navigate to the frontend directory if necessary
          dir('application/front-end') {  // Adjusted to match the correct path in your repo
            // Display Node.js version
            sh 'node --version'

            // Install dependencies
            sh 'npm install'

            // Build the front-end application
            sh 'npm run build'
          }
        }
      }
    }
  }
}
